<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lucid Coke Calculator</title>
    <script src="https://cdn.jsdelivr.net/npm/react@18/umd/react.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center">
    <div id="root"></div>
    <script type="text/babel">
        function Calculator() {
            const [inputVariable, setInputVariable] = React.useState('leaves');
            const [inputValue, setInputValue] = React.useState('');
            const [results, setResults] = React.useState(null);

            const ratios = {
                leaves_to_blend: 200 / 100,
                cement_to_blend: 4 / 100,
                blend_to_paste: 25 / 10,
                twostroke_to_paste: 2 / 10,
                paste_to_coke: 2 / 3,
                acid_to_coke: 1 / 3,
                baggies_to_coke: 3 / 3
            };

            const calculateMaterials = () => {
                const value = parseFloat(inputValue);
                if (isNaN(value) || value < 0) {
                    setResults({ error: 'Please enter a valid positive number' });
                    return;
                }

                const result = {
                    leaves: 0,
                    cement: 0,
                    blend: 0,
                    two_stroke: 0,
                    paste: 0,
                    acid: 0,
                    baggies: 0,
                    coke: 0
                };

                if (inputVariable === 'coke') {
                    result.coke = value;
                    result.paste = value * ratios.paste_to_coke;
                    result.acid = value * ratios.acid_to_coke;
                    result.baggies = value * ratios.baggies_to_coke;
                    result.blend = result.paste * ratios.blend_to_paste;
                    result.two_stroke = result.paste * ratios.twostroke_to_paste;
                    result.leaves = result.blend * ratios.leaves_to_blend;
                    result.cement = result.blend * ratios.cement_to_blend;
                } else if (inputVariable === 'paste') {
                    result.paste = value;
                    result.coke = value / ratios.paste_to_coke;
                    result.acid = result.coke * ratios.acid_to_coke;
                    result.baggies = result.coke * ratios.baggies_to_coke;
                    result.blend = value * ratios.blend_to_paste;
                    result.two_stroke = value * ratios.twostroke_to_paste;
                    result.leaves = result.blend * ratios.leaves_to_blend;
                    result.cement = result.blend * ratios.cement_to_blend;
                } else if (inputVariable === 'acid') {
                    result.acid = value;
                    result.coke = value / ratios.acid_to_coke;
                    result.paste = result.coke * ratios.paste_to_coke;
                    result.baggies = result.coke * ratios.baggies_to_coke;
                    result.blend = result.paste * ratios.blend_to_paste;
                    result.two_stroke = result.paste * ratios.twostroke_to_paste;
                    result.leaves = result.blend * ratios.leaves_to_blend;
                    result.cement = result.blend * ratios.cement_to_blend;
                } else if (inputVariable === 'baggies') {
                    result.baggies = value;
                    result.coke = value / ratios.baggies_to_coke;
                    result.paste = result.coke * ratios.paste_to_coke;
                    result.acid = result.coke * ratios.acid_to_coke;
                    result.blend = result.paste * ratios.blend_to_paste;
                    result.two_stroke = result.paste * ratios.twostroke_to_paste;
                    result.leaves = result.blend * ratios.leaves_to_blend;
                    result.cement = result.blend * ratios.cement_to_blend;
                } else if (inputVariable === 'blend') {
                    result.blend = value;
                    result.paste = value / ratios.blend_to_paste;
                    result.two_stroke = result.paste * ratios.twostroke_to_paste;
                    result.coke = result.paste / ratios.paste_to_coke;
                    result.acid = result.coke * ratios.acid_to_coke;
                    result.baggies = result.coke * ratios.baggies_to_coke;
                    result.leaves = value * ratios.leaves_to_blend;
                    result.cement = value * ratios.cement_to_blend;
                } else if (inputVariable === 'two_stroke') {
                    result.two_stroke = value;
                    result.paste = value / ratios.twostroke_to_paste;
                    result.blend = result.paste * ratios.blend_to_paste;
                    result.coke = result.paste / ratios.paste_to_coke;
                    result.acid = result.coke * ratios.acid_to_coke;
                    result.baggies = result.coke * ratios.baggies_to_coke;
                    result.leaves = result.blend * ratios.leaves_to_blend;
                    result.cement = result.blend * ratios.cement_to_blend;
                } else if (inputVariable === 'leaves') {
                    result.leaves = value;
                    result.blend = value / ratios.leaves_to_blend;
                    result.cement = result.blend * ratios.cement_to_blend;
                    result.paste = result.blend * ratios.blend_to_paste;
                    result.two_stroke = result.paste * ratios.twostroke_to_paste;
                    result.coke = result.paste / ratios.paste_to_coke;
                    result.acid = result.coke * ratios.acid_to_coke;
                    result.baggies = result.coke * ratios.baggies_to_coke;
                } else if (inputVariable === 'cement') {
                    result.cement = value;
                    result.blend = value / ratios.cement_to_blend;
                    result.leaves = result.blend * ratios.leaves_to_blend;
                    result.paste = result.blend * ratios.blend_to_paste;
                    result.two_stroke = result.paste * ratios.twostroke_to_paste;
                    result.coke = result.paste / ratios.paste_to_coke;
                    result.acid = result.coke * ratios.acid_to_coke;
                    result.baggies = result.coke * ratios.baggies_to_coke;
                }

                // Round results to 2 decimal places
                for (let key in result) {
                    result[key] = Math.round(result[key] * 100) / 100;
                }

                setResults(result);
            };

            const handleReset = () => {
                setInputValue('');
                setResults(null);
            };

            const copyResults = () => {
                if (!results || results.error) return;
                const text = Object.entries(results)
                    .map(([key, value]) => `${key.replace('_', ' ').replace(/\b\w/g, c => c.toUpperCase())}: ${value}`)
                    .join('\n');
                navigator.clipboard.writeText(text);
                alert('Results copied to clipboard!');
            };

            return (
                <div className="bg-white p-6 rounded-lg shadow-lg max-w-md w-full">
                    <h1 className="text-2xl font-bold text-center mb-4">Lucid Coke Calculator</h1>
                    <div className="space-y-4">
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Select Material</label>
                            <select
                                className="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                value={inputVariable}
                                onChange={(e) => setInputVariable(e.target.value)}
                            >
                                <option value="leaves">Leaves</option>
                                <option value="cement">Cement</option>
                                <option value="blend">Blend</option>
                                <option value="two_stroke">Two Stroke</option>
                                <option value="paste">Paste</option>
                                <option value="acid">Acid</option>
                                <option value="baggies">Baggies</option>
                                <option value="coke">Coke</option>
                            </select>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Enter Quantity</label>
                            <input
                                type="number"
                                className="mt-1 block w-full p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                value={inputValue}
                                onChange={(e) => setInputValue(e.target.value)}
                                placeholder="Enter quantity"
                                min="0"
                                step="any"
                            />
                        </div>
                        <div className="flex space-x-2">
                            <button
                                className="w-full bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 transition"
                                onClick={calculateMaterials}
                            >
                                Calculate
                            </button>
                            <button
                                className="w-full bg-gray-300 text-gray-700 p-2 rounded-md hover:bg-gray-400 transition"
                                onClick={handleReset}
                            >
                                Reset
                            </button>
                        </div>
                    </div>
                    {results && (
                        <div className="mt-6">
                            <div className="flex justify-between items-center">
                                <h2 className="text-lg font-semibold">Results:</h2>
                                <button
                                    className="text-sm text-blue-600 hover:underline"
                                    onClick={copyResults}
                                >
                                    Copy Results
                                </button>
                            </div>
                            {results.error ? (
                                <p className="text-red-600">{results.error}</p>
                            ) : (
                                <ul className="list-disc pl-5 mt-2">
                                    {Object.entries(results).map(([key, value]) => (
                                        <li key={key} className="text-gray-700">
                                            {key.replace('_', ' ').replace(/\b\w/g, c => c.toUpperCase())}: {value}
                                        </li>
                                    ))}
                                </ul>
                            )}
                        </div>
                    )}
                </div>
            );
        }

        ReactDOM.render(<Calculator />, document.getElementById('root'));
    </script>
</body>
</html>
